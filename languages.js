// Language configuration for Super Agent Party website
const translations = {
  en: {
    // Navigation
    "github": "GitHub",
    "home": "Home",
    "download": "Download",
    "plugins": "Plugins",
    "blog": "Blog",
    
    // index.html - Hero Section
    "main_subtitle": "An AI desktop companion with unlimited possibilities",
    "get_started": "Get Started",
    "view_docs": "Documentation",
    
    // index.html - Core Features (Scroll Rows)
    "core_features": "Core Features",
    
    "omnichannel": "Omnichannel Deployment",
    "omnichannel_desc": "One-click deployment to Desktop, QQ, Discord, Telegram, Twitch, YouTube, and more. Ready to use out of the box.",
    
    "ecosystem": "Ecosystem Integration",
    "ecosystem_desc": "Connect standard workflows as toolchains: Home Assistant, Claude Code, ComfyUI, MCP, A2A, and Dify.",
    
    "enhancement": "Seamless Enhancement",
    "enhancement_desc": "Upgrade LLMs without code: Web access, Permanent Memory, RAG, Code Execution, Vision & Automation.",
    
    "extensions": "Extension Marketplace",
    "extensions_desc": "Customizable extension development with a community marketplace for sharing capabilities to meet personalized needs.",
    
    "interfaces": "Open Interfaces",
    "interfaces_desc": "OpenAI API compatible, MCP protocol support, VRM/VMC for 3D avatars, and WebXR ready for immersive experiences.",
    
    "compatibility": "Platform Compatibility",
    "compatibility_desc": "Native support for Windows, macOS, Linux, Docker containers, and Web-based cloud services.",

    // index.html - Detailed Capabilities (Terminal List)
    "system_capabilities": "Capabilities",
    
    "feat_model_title": "Model Services",
    "feat_model_desc": "Support OpenAI, Ollama, Dify, and multi-modal fusion (Roleplay/Vision/TTS/STT).",
    
    "feat_vrm_title": "VRM Avatar Robot",
    "feat_vrm_desc": "Custom 3D avatars, voice interaction, transparent OBS streaming, dual-way VMC protocol support.",
    
    "feat_platforms_title": "Message & Live Bots",
    "feat_platforms_desc": "Connects with QQ, Feishu, Discord, Telegram, Bilibili, YouTube, Twitch.",
    
    "feat_broadcast_title": "Broadcasting Agent",
    "feat_broadcast_desc": "Long text/ePub TTS, multi-voice, digital human broadcasting, batch audio export.",
    
    "feat_ui_title": "Advanced UI & Tools",
    "feat_ui_desc": "Mermaid/HTML rendering, capsule mode, screenshot analysis, sandboxed code execution, file system ops.",
    
    "feat_rpg_title": "Roleplay & Memory",
    "feat_rpg_desc": "SillyTavern card support, distinct character voices, long-term memory, narrator mode.",
    
    "feat_dev_title": "Developer Ready",
    "feat_dev_desc": "Simulated OpenAI/MCP APIs, custom toolchain (HTTP/LLM), extension system.",
    
    "feat_storage_title": "Privacy & Storage",
    "feat_storage_desc": "Local data storage. NAS support for private file/image hosting.",
    
    "api_ready": "API Ready",
    "waiting_connection": "Waiting for connection...",

    // download.html content (Existing content preserved)
    "download_title": "Download Super Agent Party",
    "download_subtitle": "Choose your platform and have your own AI desktop companion in minutes",
    "recommended_system": "Recommended for Your System",
    "detecting_system": "Detecting your operating system...",
    "one_click_download": "One-Click Download",
    "cloud_storage_downloads": "Cloud Storage Downloads",
    "password": "Password",
    "direct_access": "Direct access",
    "integrated_package": "Integrated Package",
    "integrated_package_desc": "No installation required, supports one-click updates to latest version",
    "download_7z": "Download 7Z",
    "desktop_installer": "Desktop Installer",
    "desktop_installer_desc": "Traditional Windows installer with desktop integration",
    "download_exe": "Download EXE",
    "desktop_app": "Desktop App",
    "desktop_app_desc": "Native macOS application with system integration",
    "download_dmg": "Download DMG",
    "appimage": "AppImage",
    "appimage_desc": "Universal Linux format, no installation required",
    "download_appimage": "Download AppImage",
    "deb_package": "DEB Package",
    "deb_package_desc": "For Ubuntu/Debian systems with package management",
    "download_deb": "Download DEB",
    "container_deployment": "Container Deployment",
    "container_deployment_desc": "Run in any environment with Docker support. Web interface only.",
    "recommended": "RECOMMENDED",
    "access_at": "Access at",
    "data_persisted_in": "Data persisted in",
    "m_chip_only": "M-chip only",
    "system_not_detected": "System Not Detected",
    "mobile_detected": "Mobile Device Detected",
    "mobile_not_supported": "Super Agent Party is currently not available for mobile devices",
    "mobile_recommendation": "Please use a desktop computer with Windows, macOS or Linux to download and use Super Agent Party",
    "cloud_storage_downloads": "Download Mirrors",
    "mirror_china": "ModelScope (Recommended for China)",
    "mirror_global": "GitHub Releases (Global Recommended)",
    "modelscope_desc": "High-speed access for users in mainland China",
    "github_releases_desc": "Latest stable releases on GitHub",
    "direct_download": "Direct Download",
    "download_recommended": "Recommended",
    "download_mirror": "Mirror",
    "global_link_text": "Global Release (GitHub)",
    "china_link_text": "China Mirror (ModelScope)",

    // Plugins page
    "plugins_description": "Plugins that add new functionalities to Super Agent Party",
    "plugin_author": "Author",
    "adding_your_own_plugin": "Adding Your Own Plugin",
    "add_plugin_description": "Want to add your plugin to this list? You can easily update the plugins by modifying the plugins configuration file.",
    "plugin_development_info": "For more detailed information about plugin development and submission, please refer to the",
    "copy": "Copy Link",
    "copied": "Copied!",
    "copy_error": "Cannot copy link: ",
    "copy_failed": "Failed to copy link, please copy manually",
    "all": "All",
    
    // Footer
    "footer_copyright": "© 2025 Super Agent Party. Open source project available on GitHub."
  },
  
  zh: {
    // Navigation
    "github": "GitHub",
    "home": "首页",
    "download": "下载",
    "plugins": "插件",
    "blog": "博客",
    
    // index.html - Hero Section
    "main_subtitle": "一款拥有无限可能的AI桌面伴侣",
    "get_started": "立即开始",
    "view_docs": "查看文档",
    
    // index.html - Core Features (Scroll Rows)
    "core_features": "核心特性",
    
    "omnichannel": "全渠道一键部署",
    "omnichannel_desc": "支持将智能体配置快速部署至多类终端，兼容经典界面、桌宠、QQ、飞书、Discord、Telegram、直播机器人（B站/YouTube/Twitch）等。",
    
    "ecosystem": "生态工具互联",
    "ecosystem_desc": "自由接入第三方智能体与工作流（Home Assistant/Claude code/ComfyUI/MCP/A2A/Dify），实现跨平台能力聚合。",
    
    "enhancement": "无缝能力增强",
    "enhancement_desc": "无需代码改造实现LLM API企业级升级：集成知识库、联网、永久记忆、代码执行、多模态及深度思考控制。",
    
    "extensions": "扩展生态丰富",
    "extensions_desc": "支持自定义扩展开发，通过官网扩展市场实现社区共享，满足个性化需求。",
    
    "interfaces": "标准化接口开放",
    "interfaces_desc": "兼容OpenAI API及MCP协议，VRM桌宠开放VMC协议，界面支持WebXR协议沉浸式体验。",
    
    "compatibility": "全平台兼容适配",
    "compatibility_desc": "覆盖Windows/macOS/Linux原生运行环境，支持Docker容器化部署与Web端云服务。",

    // index.html - Detailed Capabilities (Terminal List)
    "system_capabilities": "系统能力概览",
    
    "feat_model_title": "常见模型服务商支持",
    "feat_model_desc": "已支持市面上常见的本地部署及云服务商接口，如：OpenAI/Ollama/Dify等，支持多模态模型融合。",
    
    "feat_vrm_title": "VRM桌宠机器人",
    "feat_vrm_desc": "高度自由，支持自定义形象/动作/语音交互/打断，支持透明推流及双向VMC协议。",
    
    "feat_platforms_title": "消息平台机器人",
    "feat_platforms_desc": "目前已支持QQ、飞书、Discord、Telegram，后续会支持更多平台。",
    
    "feat_broadcast_title": "播报机器人",
    "feat_broadcast_desc": "支持长文播报、多语音、数字人、超长文本批量转语音下载，支持电子书epub解析。",
    
    "feat_ui_title": "对话界面与工具",
    "feat_ui_desc": "支持公式/Mermaid/HTML代码渲染，胶囊模式/小助手模式，支持截图分析、沙盒代码执行、文件操作。",
    
    "feat_rpg_title": "角色扮演",
    "feat_rpg_desc": "支持酒馆(SillyTavern)角色卡、异色语音、长期记忆、旁白音色及表情包支持。",
    
    "feat_dev_title": "对外接口与扩展",
    "feat_dev_desc": "开放模拟OpenAI和MCP接口，支持任意LLM接口作为工具，拥有完善的扩展插件系统。",
    
    "feat_storage_title": "存储空间",
    "feat_storage_desc": "所有文件本地存储。支持NAS部署，可作为内网个人图床、文件床使用。",
    
    "api_ready": "API 就绪",
    "waiting_connection": "等待连接...",

    // download.html content
    "download_title": "下载 Super Agent Party",
    "download_subtitle": "选择您的平台，几分钟内即可拥有你的专属AI桌面伴侣",
    "recommended_system": "推荐系统下载",
    "detecting_system": "正在检测您的操作系统...",
    "one_click_download": "一键下载",
    "cloud_storage_downloads": "网盘下载",
    "password": "提取码",
    "direct_access": "直接访问",
    "integrated_package": "集成软件包",
    "integrated_package_desc": "无需安装，支持一键更新到最新版本",
    "download_7z": "下载 7Z",
    "desktop_installer": "桌面安装程序",
    "desktop_installer_desc": "传统Windows安装程序，集成桌面功能",
    "download_exe": "下载 EXE",
    "desktop_app": "桌面应用",
    "desktop_app_desc": "原生macOS应用程序，系统集成",
    "download_dmg": "下载 DMG",
    "appimage": "AppImage格式",
    "appimage_desc": "通用Linux格式，无需安装",
    "download_appimage": "下载 AppImage",
    "deb_package": "DEB 安装包",
    "deb_package_desc": "适用于Ubuntu/Debian系统，支持包管理",
    "download_deb": "下载 DEB",
    "container_deployment": "容器部署",
    "container_deployment_desc": "在任何支持Docker的环境中运行。仅网页界面。",
    "recommended": "推荐",
    "access_at": "访问地址",
    "data_persisted_in": "数据保存在",
    "m_chip_only": "仅支持M芯片",
    "system_not_detected": "无法检测系统",
    "mobile_detected": "检测到移动设备",
    "mobile_not_supported": "Super Agent Party 目前不支持移动设备",
    "mobile_recommendation": "请使用 Windows、macOS 或 Linux 桌面系统下载并使用 Super Agent Party",
    "cloud_storage_downloads": "下载镜像",
    "mirror_china": "魔搭社区 (中国用户推荐)",
    "mirror_global": "GitHub Releases (国际用户推荐)",
    "modelscope_desc": "为中国大陆用户提供极速下载体验",
    "github_releases_desc": "GitHub 官方发布渠道，获取最新版本",
    "direct_download": "立即下载",
    "download_recommended": "推荐",
    "download_mirror": "备用",
    "global_link_text": "国际用户下载 (GitHub)",
    "china_link_text": "中国用户下载 (魔搭社区)",

    // Plugins page
    "plugins_description": "为 Super Agent Party 增添新功能的插件",
    "plugin_author": "作者",
    "adding_your_own_plugin": "添加您自己的插件",
    "add_plugin_description": "想要将您的插件添加到此列表中？您可以通过修改插件配置文件轻松更新插件。",
    "plugin_development_info": "有关插件开发和提交的更详细信息，请参阅",
    "copy": "复制链接",
    "copied": "已复制!",
    "copy_error": "无法复制链接: ",
    "copy_failed": "复制链接失败，请手动复制",
    "all": "全部",
    
    // Footer
    "footer_copyright": "© 2025 Super Agent Party。开源项目，可在GitHub上获取。"
  }
};

// Function to get the browser language or use fallback
function getBrowserLanguage() {
  const defaultLang = 'en';
  try {
    const browserLang = navigator.language || navigator.userLanguage;
    const primaryLang = browserLang.split('-')[0]; // Get primary language code (e.g., 'en' from 'en-US')
    
    // Check if the language is supported, otherwise use default
    return (primaryLang === 'zh') ? 'zh' : defaultLang;
  } catch (e) {
    console.error('Error detecting language:', e);
    return defaultLang;
  }
}

// Function to get translation for a key
function getTranslation(key, lang) {
  if (!translations[lang] || !translations[lang][key]) {
    // Fallback to English if translation is missing
    return translations.en[key] || key;
  }
  return translations[lang][key];
}

// Initialize the page with the correct language
function initializeLanguage() {
  // Get saved language from localStorage or detect from browser
  let currentLang = localStorage.getItem('lang') || getBrowserLanguage();
  
  // Set initial language
  changeLanguage(currentLang);
  
  // Update language toggle button state
  updateToggleButton(currentLang);
}

// Function to change language
function changeLanguage(lang) {
  // Save language preference
  localStorage.setItem('lang', lang);
  
  // Update the html lang attribute
  document.documentElement.lang = lang;
  
  // Update all elements with data-i18n attribute
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(element => {
    const key = element.getAttribute('data-i18n');
    if (key) {
      element.textContent = getTranslation(key, lang);
    }
  });
  
  // Update language toggle button state
  updateToggleButton(lang);
  
  // Emit event for custom handling
  document.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: lang } }));
}

// Function to toggle between languages
function toggleLanguage() {
  const currentLang = localStorage.getItem('lang') || 'en';
  const newLang = currentLang === 'en' ? 'zh' : 'en';
  changeLanguage(newLang);
}

// Update toggle button text/state
function updateToggleButton(currentLang) {
  const toggleBtn = document.getElementById('lang-toggle');
  if (toggleBtn) {
    toggleBtn.textContent = currentLang === 'en' ? '中文' : 'English';
  }
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', initializeLanguage);