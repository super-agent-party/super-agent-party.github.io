// Language configuration for Super Agent Party website
const translations = {
  en: {
    // Navigation
    "github": "GitHub",
    "home": "Home",
    "download": "Download",
    "plugins": "Plugins",
    "dark_mode": "Dark Mode",
    "light_mode": "Light Mode",
    
    // index.html content
    "main_subtitle": "A 3D AI desktop companion with unlimited possibilities",
    "get_started": "Get Started",
    "view_docs": "View Documentation",
    "why_choose_us": "Why Choose Us",
    "why_choose_us_subtitle": "Building a pluggable LLM enhancement platform for unlimited agent capability expansion",
    
    // Features
    "seamless_enhancement": "Seamless Enhancement",
    "seamless_enhancement_desc": "Upgrade LLM APIs at the enterprise level without code modifications, seamlessly integrating knowledge bases, real-time internet connectivity, permanent memory, and other modular features into existing model interfaces",
    "omnichannel_deployment": "Omnichannel Deployment",
    "omnichannel_deployment_desc": "Quickly deploy agent configurations to multiple terminals, compatible with classic chat interfaces, official QQ robots, Bilibili live streaming interaction, VRM virtual desktop pets, and other scenarios",
    "ecosystem_tool_integration": "Ecosystem Tool Integration",
    "ecosystem_tool_integration_desc": "Freely connect third-party agents and workflows as tool chains, achieving cross-platform capability aggregation through the agent-party architecture",
    
    // download.html content
    "download_title": "Download Super Agent Party",
    "download_subtitle": "Choose your platform and have your own AI desktop companion in minutes",
    "recommended_system": "Recommended for Your System",
    "detecting_system": "Detecting your operating system...",
    "one_click_download": "One-Click Download",
    "cloud_storage_downloads": "Cloud Storage Downloads",
    "password": "Password",
    "direct_access": "Direct access",
    "integrated_package": "Integrated Package",
    "integrated_package_desc": "No installation required, supports one-click updates to latest version",
    "download_zip": "Download ZIP",
    "desktop_installer": "Desktop Installer",
    "desktop_installer_desc": "Traditional Windows installer with desktop integration",
    "download_exe": "Download EXE",
    "desktop_app": "Desktop App",
    "desktop_app_desc": "Native macOS application with system integration",
    "download_dmg": "Download DMG",
    "appimage": "AppImage",
    "appimage_desc": "Universal Linux format, no installation required",
    "download_appimage": "Download AppImage",
    "deb_package": "DEB Package",
    "deb_package_desc": "For Ubuntu/Debian systems with package management",
    "download_deb": "Download DEB",
    "container_deployment": "Container Deployment",
    "container_deployment_desc": "Run in any environment with Docker support. Web interface only.",
    "recommended": "RECOMMENDED",
    "access_at": "Access at",
    "data_persisted_in": "Data persisted in",
    "m_chip_only": "M-chip only",
    "system_not_detected": "System Not Detected",
    
    // Plugins page
    "plugins_description": "Plugins that add new functionalities to Super Agent Party",
    "plugin_author": "Author",
    "adding_your_own_plugin": "Adding Your Own Plugin",
    "add_plugin_description": "Want to add your plugin to this list? You can easily update the plugins by modifying the plugins configuration file.",
    "plugin_development_info": "For more detailed information about plugin development and submission, please refer to the",
    "copy": "Copy Link",
    "copied": "Copied!",
    "copy_error": "Cannot copy link: ",
    "copy_failed": "Failed to copy link, please copy manually",
    
    // Footer
    "footer_copyright": "© 2025 Super Agent Party. Open source project available on GitHub."
  },
  zh: {
    // Navigation
    "github": "GitHub",
    "home": "首页",
    "download": "下载",
    "plugins": "插件",
    "dark_mode": "深色模式",
    "light_mode": "浅色模式",
    
    // index.html content
    "main_subtitle": "一款拥有无限可能的3D版AI桌面伴侣",
    "get_started": "立即开始",
    "view_docs": "查看文档",
    "why_choose_us": "为什么选择我们",
    "why_choose_us_subtitle": "打造可插拔的LLM增强中台，实现智能体能力的无限扩展",
    
    // Features
    "seamless_enhancement": "无缝能力增强",
    "seamless_enhancement_desc": "无需代码改造即可实现LLM API企业级升级，为现有模型接口无缝集成知识库、实时联网、永久记忆等模块化功能",
    "omnichannel_deployment": "全渠道一键部署",
    "omnichannel_deployment_desc": "支持将智能体配置快速部署至多类终端，已兼容经典聊天界面、QQ官方机器人、B站直播互动、VRM虚拟桌宠等场景",
    "ecosystem_tool_integration": "生态工具互联",
    "ecosystem_tool_integration_desc": "可自由接入第三方智能体与工作流作为工具链，通过agent-party架构实现跨平台能力聚合",
    
    // download.html content
    "download_title": "下载 Super Agent Party",
    "download_subtitle": "选择您的平台，几分钟内即可拥有你的专属AI桌面伴侣",
    "recommended_system": "推荐系统下载",
    "detecting_system": "正在检测您的操作系统...",
    "one_click_download": "一键下载",
    "cloud_storage_downloads": "云存储下载",
    "password": "提取码",
    "direct_access": "直接访问",
    "integrated_package": "集成软件包",
    "integrated_package_desc": "无需安装，支持一键更新到最新版本",
    "download_zip": "下载 ZIP",
    "desktop_installer": "桌面安装程序",
    "desktop_installer_desc": "传统Windows安装程序，集成桌面功能",
    "download_exe": "下载 EXE",
    "desktop_app": "桌面应用",
    "desktop_app_desc": "原生macOS应用程序，系统集成",
    "download_dmg": "下载 DMG",
    "appimage": "AppImage格式",
    "appimage_desc": "通用Linux格式，无需安装",
    "download_appimage": "下载 AppImage",
    "deb_package": "DEB 安装包",
    "deb_package_desc": "适用于Ubuntu/Debian系统，支持包管理",
    "download_deb": "下载 DEB",
    "container_deployment": "容器部署",
    "container_deployment_desc": "在任何支持Docker的环境中运行。仅网页界面。",
    "recommended": "推荐",
    "access_at": "访问地址",
    "data_persisted_in": "数据保存在",
    "m_chip_only": "仅支持M芯片",
    "system_not_detected": "无法检测系统",
    
    // Plugins page
    "plugins_description": "为 Super Agent Party 增添新功能的插件",
    "plugin_author": "作者",
    "adding_your_own_plugin": "添加您自己的插件",
    "add_plugin_description": "想要将您的插件添加到此列表中？您可以通过修改插件配置文件轻松更新插件。",
    "plugin_development_info": "有关插件开发和提交的更详细信息，请参阅",
    "copy": "复制链接",
    "copied": "已复制!",
    "copy_error": "无法复制链接: ",
    "copy_failed": "复制链接失败，请手动复制",
    
    // Footer
    "footer_copyright": "© 2025 Super Agent Party。开源项目，可在GitHub上获取。"
  }
};

// Function to get the browser language or use fallback
function getBrowserLanguage() {
  const defaultLang = 'en';
  try {
    const browserLang = navigator.language || navigator.userLanguage;
    const primaryLang = browserLang.split('-')[0]; // Get primary language code (e.g., 'en' from 'en-US')
    
    // Check if the language is supported, otherwise use default
    return (primaryLang === 'zh') ? 'zh' : defaultLang;
  } catch (e) {
    console.error('Error detecting language:', e);
    return defaultLang;
  }
}

// Function to get translation for a key
function getTranslation(key, lang) {
  if (!translations[lang] || !translations[lang][key]) {
    // Fallback to English if translation is missing
    return translations.en[key] || key;
  }
  return translations[lang][key];
}

// Initialize the page with the correct language
function initializeLanguage() {
  // Get saved language from localStorage or detect from browser
  let currentLang = localStorage.getItem('lang') || getBrowserLanguage();
  
  // Set initial language
  changeLanguage(currentLang);
  
  // Update language toggle button state
  updateToggleButton(currentLang);
}

// Function to change language
function changeLanguage(lang) {
  // Save language preference
  localStorage.setItem('lang', lang);
  
  // Update the html lang attribute
  document.documentElement.lang = lang;
  
  // Update all elements with data-i18n attribute
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(element => {
    const key = element.getAttribute('data-i18n');
    if (key) {
      element.textContent = getTranslation(key, lang);
    }
  });
  
  // Update language toggle button state
  updateToggleButton(lang);
  
  // Emit event for custom handling
  document.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: lang } }));
}

// Function to toggle between languages
function toggleLanguage() {
  const currentLang = localStorage.getItem('lang') || 'en';
  const newLang = currentLang === 'en' ? 'zh' : 'en';
  changeLanguage(newLang);
}

// Update toggle button text/state
function updateToggleButton(currentLang) {
  const toggleBtn = document.getElementById('lang-toggle');
  if (toggleBtn) {
    toggleBtn.textContent = currentLang === 'en' ? '中文' : 'English';
  }
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', initializeLanguage);
